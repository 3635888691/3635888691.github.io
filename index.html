<!DOCTYPE html><html lang="ch" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>老北京大杀器</title><meta name="author" content="老北京大杀器"><meta name="copyright" content="老北京大杀器"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="枕风宿雪多年，我与虎谋早餐">
<meta property="og:type" content="website">
<meta property="og:title" content="老北京大杀器">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="老北京大杀器">
<meta property="og:description" content="枕风宿雪多年，我与虎谋早餐">
<meta property="og:locale">
<meta property="og:image" content="http://example.com/img/20251030210753.jpg">
<meta property="article:author" content="老北京大杀器">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/20251030210753.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "老北京大杀器",
  "alternateName": [
    "example.com"
  ],
  "url": "http://example.com/"
}</script><link rel="shortcut icon" href="/img/20251030210753.jpg"><link rel="canonical" href="http://example.com/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '老北京大杀器',
  isHighlightShrink: false,
  isToc: false,
  pageType: 'home'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/20251030210816.jpg);"></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url(/img/20251030210816.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">老北京大杀器</span></a></span><div id="menus"></div></nav><div id="site-info"><h1 id="site-title">老北京大杀器</h1></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts nc" id="recent-posts"><div class="recent-post-items"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2025/11/07/blog5/" title="Untitled">Untitled</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2025-11-07T15:13:00.303Z" title="Created 2025-11-07 23:13:00">2025-11-07</time></span></div><div class="content">Ubuntu22.04下flameshot的使用问题</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2025/11/07/blog4/" title="Untitled">Untitled</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2025-11-07T11:58:57.189Z" title="Created 2025-11-07 19:58:57">2025-11-07</time></span></div><div class="content">TSCTF-J2025 pivot程序行为很简单，调用write（）和read（），只溢出了16个字节。本题可分成泄露libc基址和构造ROP两个步骤  libc基址现在遇到的泄露方式 plt got表泄露：NO PIE 格式化字符串：打印栈上库函数地址 _IO_FILE结构体：需要能够打印DATA段   栈迁移在本题中的作用 迁移rbp便于write泄露 &#115;&#x74;&#x64;&#x6f;&#x75;&#116;&#64;&#x47;&#x4c;&#x49;&#66;&#x43;&#x5f;&#x32;&#46;&#x32;&#x2e;&#53;结构体 弥补只泄露16字节的缺陷   为什么要对rbp进行迁移？read和write这类包装的系统调用函数几乎不会改变寄存器，可以先调用read，将write的第一个和第二个参数设为与read相同，即123.text:00000000004011EA                 lea     rax, [rbp+buf].text:00000000004011F1                 mov     ed...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2025/10/30/blog3/" title="These Days">These Days</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2025-10-30T11:11:57.000Z" title="Created 2025-10-30 19:11:57">2025-10-30</time></span></div><div class="content">我已记不清这两个月以来都发生什么了，可以梳理一下高中：C&#x2F;C++、算法和数据结构，也碰过计算机网络和操作系统，完全看不懂，有用的就这么点了，可能是对计算机底层的强烈兴趣，引领我进入PWN的方向2025.8.28：班级通知群出现天璇招新通知，闻着味进群，获得各个方向入门指引（只看了PWN），得知招新赛时间和MOECTF的存在2025.8.29——2025.9.8：延续高考暑假摆烂状态2025.9.9——2025.9.28（国庆前）：在MOECTF中完成汇编语言、python基础语句、linux安全机制（金丝雀、PIE&amp;ASLR、NX）、字节流、文件描述符、Ret2text、Ret2shellcode、Ret2libc、伪随机数的学习2025.9.29——2025.10.9：国庆回家了，彻底摆烂2025.10.10——2025.10.12（TSCTF-J）：打招新赛，学会了GOT&amp;PLT、Ret2syscall、格式化字符串2025.10.13——2025.10.29：等待面试结果，几乎没有什么动力。2025.10.30:复活第一天，完成博客搭建。之后想干嘛...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2025/10/30/blog2/" title="WriteUp TSCTF-J 2025">WriteUp TSCTF-J 2025</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2025-10-30T10:39:59.000Z" title="Created 2025-10-30 18:39:59">2025-10-30</time></span></div><div class="content">当初比赛提交上去的WP是PDF，那么借此学习一下markdown Writeup 2025.10.13 TSCTF-J 老北京大杀器作为学习者，这篇 WP 不只为了证明成绩，也起到一个知识梳理的作用。 Ret作为 pwn 第一题，我们必须要先知道函数调用的原理。X86 指令集架构约定函数调用：将返回地址、父函数栈底 rbp 依次压栈， rbp 设为当前栈顶指针所指地址（mov rbp , rsp） 建立新的栈帧。然后将会为函数自身局部变量开辟栈空间。IDA 静态分析发现 backdoor（）和 vuln（）打开看，vuln 开了一个大小 16 的数组，使用 gets（）读入任意长度的字节数，存在栈溢出，backdoor 是真的 backdoor（内涵 dinner），内含真正的 system（“&#x2F;bin&#x2F;sh”）那么非常简单，只需要覆盖返回地址为 backdoor 即可。IDA 查看 backdoor mov rbp , rsp 指令地址，顺手看到地址前有 0x40，没有开启 PIE，直接用就行。为什么不直接用函数地址？因为指令集架构约定我们要栈 16 字节对...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2025/10/30/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2-citation-2/" title="\（%@__@%）/">\（%@__@%）/</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2025-10-30T09:21:15.000Z" title="Created 2025-10-30 17:21:15">2025-10-30</time></span></div><div class="content">This is a stupid markdown.</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2025/10/30/hello-world/" title="Hello World">Hello World</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2025-10-30T04:29:20.341Z" title="Created 2025-10-30 12:29:20">2025-10-30</time></span></div><div class="content">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;  More info: Writing Run server1$ hexo server  More info: Server Generate static files1$ hexo generate  More info: Generating Deploy to remote sites1$ hexo deploy  More info: Deployment </div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/20251030210753.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">老北京大杀器</div><div class="author-info-description">枕风宿雪多年，我与虎谋早餐</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is a stupid announcement</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/07/blog5/" title="Untitled">Untitled</a><time datetime="2025-11-07T15:13:00.303Z" title="Created 2025-11-07 23:13:00">2025-11-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/07/blog4/" title="Untitled">Untitled</a><time datetime="2025-11-07T11:58:57.189Z" title="Created 2025-11-07 19:58:57">2025-11-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/30/blog3/" title="These Days">These Days</a><time datetime="2025-10-30T11:11:57.000Z" title="Created 2025-10-30 19:11:57">2025-10-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/30/blog2/" title="WriteUp TSCTF-J 2025">WriteUp TSCTF-J 2025</a><time datetime="2025-10-30T10:39:59.000Z" title="Created 2025-10-30 18:39:59">2025-10-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/30/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2-citation-2/" title="\（%@__@%）/">\（%@__@%）/</a><time datetime="2025-10-30T09:21:15.000Z" title="Created 2025-10-30 17:21:15">2025-10-30</time></div></div></div></div><div class="card-widget card-archives">
    <div class="item-headline">
      <i class="fas fa-archive"></i>
      <span>Archives</span>
      
    </div>
  
    <ul class="card-archive-list">
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/11/">
            <span class="card-archive-list-date">
              November 2025
            </span>
            <span class="card-archive-list-count">2</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/10/">
            <span class="card-archive-list-date">
              October 2025
            </span>
            <span class="card-archive-list-count">4</span>
          </a>
        </li>
      
    </ul>
  </div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>Website Info</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">Article Count :</div><div class="item-count">6</div></div><div class="webinfo-item"><div class="item-name">Unique Visitors :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">Page Views :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">Last Update :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-11-08T06:22:50.438Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By 老北京大杀器</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.1</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.1"></script><script src="/js/main.js?v=5.5.1"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>